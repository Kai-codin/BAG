<!DOCTYPE html>
<!-- Roy Curtis 2018, MIT license -->
<html lang="en">
<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Rail Announcement Generator</title>

  <link href="css/index.css" rel="stylesheet" type="text/css"/>
  <!-- TODO: Lang files -->
  <!-- TODO: Animations -->
  <!-- TODO: Offline cache manifest -->

  <meta name="apple-mobile-web-app-capable"          content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title"            content="RAG">
</head>

<body>
  <!-- The electronic scrolling text board at the top -->
  <div id="marquee">
    Is Javascript enabled?
  </div>

  <!-- Toolbar of RAG operations -->
  <menu id="toolbar">
    <button tabindex="1" id="btnPlay" title="Play phrase">
      <svg class="play"><use xlink:href="css/icons/icoMoon.svg#icon-play"></use></svg>
    </button>

    <button tabindex="1" id="btnStop" title="Stop playing phrase">
      <svg class="stop"><use xlink:href="css/icons/icoMoon.svg#icon-stop"></use></svg>
    </button>

    <button tabindex="1" id="btnShuffle" title="Generate random phrase">
      <svg><use xlink:href="css/icons/icoMoon.svg#icon-shuffle"></use></svg>
    </button>

    <button tabindex="1" id="btnSave" title="Save state to storage">
      <svg><use xlink:href="css/icons/icoMoon.svg#icon-save"></use></svg>
    </button>

    <button tabindex="1" id="btnLoad" title="Recall state from storage">
      <svg><use xlink:href="css/icons/icoMoon.svg#icon-recall"></use></svg>
    </button>

    <button tabindex="1" id="btnSettings" title="Open settings">
      <svg><use xlink:href="css/icons/icoMoon.svg#icon-settings"></use></svg>
    </button>
  </menu>

  <!-- The phrase editor -->
  <div id="editor">
    Is Javascript enabled?
  </div>

  <!-- The settings dialog -->
  <div id="settings">
    <button tabindex="2" id="btnResetSettings" title="Reset settings to defaults">
      Reset to defaults
    </button>

    <button tabindex="2" id="btnSaveSettings" title="Save & close settings">
      Save & close
    </button>

    <h1>Speech</h1>

    <form id="frmVox">
      <label for="selVoxChoice">Voice</label>
      <select tabindex="2" id="selVoxChoice">
        <option disabled selected value="">None available</option>
      </select>

      <label for="rangeVoxVol">Volume</label>
      <input tabindex="2" id="rangeVoxVol" type="range"
             min="0" max="1" value="1" step="0.05"/>

      <label for="rangeVoxPitch">Pitch</label>
      <input tabindex="2" id="rangeVoxPitch" type="range"
             min="0" max="2" value="1" step="0.1"/>

      <label for="rangeVoxRate">Rate</label>
      <input tabindex="2" id="rangeVoxRate" type="range"
             min="0.1" max="2" value="1" step="0.1"/>

      <button tabindex="2" id="btnVoxTest" title="Test speech">
        Test speech
      </button>
    </form>

    <h1>Legal & Acknowledgements</h1>

    <p>
      Rail Announcement Generator was built by Roy Curtis in 2018, under the MIT license.
      Built using TypeScript, Stylus, JetBrains WebStorm, Node, and Node Package Manager.
      Uses the IcoMoon-Free icon pack by Keyamoon. Uses the 5by7 font by Peter Wiegel.
      Uses the Draggable library by Shopify.
      With thanks to: Paul Casillas for his recordings of station announcements on
      YouTube, WhatDoTheyKnow for hosting freedom of information reqest responses that
      contain announcement data, "Mark" for making said FOI requests, and various
      StackOverflow contributors (where attributed) for code snippets and advice.
      Thank you also to Stitch, Spin, Tropic, Poster, Devon, Robro, Grant, Bjarke, Nik,
      Dylan, rjlan, Fyrrian, CGDoctor8, Mikko, Griffin, Leroy, Maitre, Shilo, Pat, Kristi
      Kates and her entire community for the love, testing, and encouragement.
      No user-inputted or generated data is ever sent to a remote server, at any time.
      Local storage is used only to store and recall JSON state and application settings,
      on user's explicit and intentional request.
      This application uses phrases, vocabulary, and station names from National Rail's
      official station announcements, and freedom of information requests by other parties
      that are not affiliated with this application.
      This application is not affiliated with, nor endorsed by, National Rail or any of
      the rail networks, companies, councils, towns and communities listed in datasets.
      None of the messages generated by this application are endorsed by either National
      Rail or any of the rail networks, companies, councils, towns and communities
      listed in the datasets, or mentioned in such generated messages.
      This application is just a hobby project; it is not meant for official use in any
      rail station, nor any context where rail customers or spectators may be expecting
      official information or announcements on train and station schedules.
      This application is not meant as a replacement for, or extension of, official
      announcement generating systems used in any rail station or train.
      Obviously, I am not a lawyer, but I hope this text makes it clear enough that this
      is just a hobby of mine, with zero commercial intent. Please enjoy, and thanks!
    </p>
  </div>

  <!-- Display size warning -->
  <div id="tooSmallScreen" class="warningScreen">
    <h1>"May I have your attention please..."</h1>

    <p>
      This display is too short to support RAG. Please make this window taller, or rotate
      your device from landscape to portrait.
    </p>
  </div>

  <!-- UI definitions for phrase element editor dialogs -->

  <div id="coachPicker" class="picker hidden">
    <header>Pick a coach</header>

    <form>
      <select title="Coach letter" tabindex="50"></select>
    </form>
  </div>

  <div id="excusePicker" class="picker fullWidth hidden">
    <header>Pick an excuse</header>

    <form>
      <chooser
        placeholder="Filter excuses..."
        title="List of delay or cancellation excuses"
        itemTitle="Click to select this excuse"
      ></chooser>
    </form>
  </div>

  <div id="integerPicker" class="picker hidden">
    <header>Pick a number</header>

    <form>
      <input id="integerPickerValue" title="Integer value" type="number">
      <label for="integerPickerValue"></label>
    </form>
  </div>

  <div id="namedPicker" class="picker fullWidth hidden">
    <header>Pick a named train</header>

    <form>
      <chooser
        placeholder="Filter train name..."
        title="List of train names"
        itemTitle="Click to select this name"
      ></chooser>
    </form>
  </div>

  <div id="phrasesetPicker" class="picker modal hidden">
    <header>Pick a phrase</header>

    <form>
      <chooser
        placeholder="Filter phrases..."
        title="List of phrases"
        itemTitle="Click to select this phrase"
      ></chooser>
    </form>
  </div>

  <div id="platformPicker" class="picker hidden">
    <header>Pick a platform</header>

    <form>
      <input title="Platform number" min="0" max="99" type="number">

      <select title="Optional platform letter">
        <option value=""></option>
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
      </select>
    </form>
  </div>

  <div id="servicePicker" class="picker fullWidth hidden">
    <header>Pick a service</header>

    <form>
      <chooser
        placeholder="Filter services..."
        title="List of service names"
        itemTitle="Click to select this service"
      ></chooser>
    </form>
  </div>

  <div id="stationPicker" class="picker fullWidth hidden">
    <header>Pick a station</header>

    <form>
      <chooser
        placeholder="Filter stations..."
        title="List of station names"
        itemTitle="Click to select or add this service"
        groupByABC
      ></chooser>
    </form>
  </div>

  <div id="stationlistPicker" class="picker modal hidden">
    <header>
      Build a station list
    </header>

    <form>
      <div class="stationList">
        <menu>
          <button class="addStation" tabindex="50" title="Add station to this list">
            Add station...
          </button>

          <button class="closePicker" tabindex="50" title="Close this picker">
            Close
          </button>
        </menu>

        <p>
          Please add at least one station to this list
        </p>

        <dl title="Draggable selection of stations for this list" tabindex="50">

        </dl>

        <div class="delStation"
             title="Drop station here to delete it from this list">
          Drop here to delete
        </div>
      </div>
    </form>
  </div>

  <div id="timePicker" class="picker hidden">
    <header>Pick a time</header>

    <form>
      <input id="timePickerValue" type="time" title="Time"
             pattern="[0-9]{2}:[0-9]{2}" required>
    </form>
  </div>

  <!-- UI definitions for common controls -->

  <div id="chooserTemplate" class="chooser hidden">
    <input class="chSearchBox" type="text" tabindex="50" title=""/>

    <dl class="chChoicesBox" tabindex="50"></dl>
  </div>

  <dd id="stationListItemTemplate" class="hidden" tabindex="-1"
      title="Drag to reorder; double-click or drag into delete zone to remove">

  </dd>

</body>

<scripts>
  <!-- National Rail vocabulary data -->
  <script src="data/nr_excuses.js"  type="text/javascript"></script>
  <script src="data/nr_named.js"    type="text/javascript"></script>
  <script src="data/nr_services.js" type="text/javascript"></script>
  <script src="data/nr_stations.js" type="text/javascript"></script>

  <!-- Third-party libraries -->
  <script src="js/vendor/draggable.js" type="text/javascript"></script>

  <!-- Application logic -->
  <script src="js/rag.js" type="text/javascript"></script>

  <script type="application/javascript">
    function init()
    {
      RAG.main({
        phrasesetEmbed: '#nrPhraseset',
        excusesData:    DATA_EXCUSES,
        namedData:      DATA_NAMED,
        servicesData:   DATA_SERVICES,
        stationsData:   DATA_STATIONS
      });
    }
  </script>

  <!-- National Rail phrase sets -->
  <!-- Has to be down here, so the phraseset can load synchronously. -->
  <iframe id="nrPhraseset" src="data/phrases.xml" onload="init()"></iframe>
</scripts>

</html>