<!DOCTYPE html>
<!-- Roy Curtis 2018, MIT license -->
<html lang="en">
<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Rail Announcement Generator</title>

  <link href="css/index.css" rel="stylesheet" type="text/css"/>
  <!-- TODO: Offline cache manifest -->
  <!-- TODO: https://introjs.com/ ? -->
  <!-- TODO: A11y                   -->
  <!-- TODO: URL state              -->

  <!-- Generated by https://realfavicongenerator.net/ -->
  <link rel="apple-touch-icon" sizes="180x180" href="res/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="res/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="res/favicon-16x16.png">
  <link rel="mask-icon" href="res/safari-pinned-tab.svg" color="#ffa500">
  <link rel="shortcut icon" href="res/favicon.ico">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="RAG">
  <meta name="application-name" content="RAG">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-config" content="res/browserconfig.xml">
  <meta name="theme-color" content="#444444">
</head>

<body>
  <!-- The main screen -->
  <div id="mainScreen">

    <!-- The electronic scrolling text board at the top -->
    <div id="marquee">
      Is Javascript enabled?
    </div>

    <!-- Toolbar of RAG operations -->
    <menu id="toolbar">
      <button tabindex="1" id="btnPlay" title="%TOOLBAR_PLAY%">
        <svg><use xlink:href="css/icons/icoMoon.svg#icon-play"></use></svg>
      </button>

      <button tabindex="1" id="btnStop" hidden title="%TOOLBAR_STOP%">
        <svg><use xlink:href="css/icons/icoMoon.svg#icon-stop"></use></svg>
      </button>

      <button tabindex="1" id="btnShuffle" title="%TOOLBAR_SHUFFLE%">
        <svg><use xlink:href="css/icons/icoMoon.svg#icon-shuffle"></use></svg>
      </button>

      <button tabindex="1" id="btnSave" title="%TOOLBAR_SAVE%">
        <svg><use xlink:href="css/icons/icoMoon.svg#icon-save"></use></svg>
      </button>

      <button tabindex="1" id="btnLoad" title="%TOOLBAR_LOAD%">
        <svg><use xlink:href="css/icons/icoMoon.svg#icon-recall"></use></svg>
      </button>

      <button tabindex="1" id="btnSettings" title="%TOOLBAR_SETTINGS%">
        <svg><use xlink:href="css/icons/icoMoon.svg#icon-settings"></use></svg>
      </button>
    </menu>

    <!-- The phrase editor -->
    <div id="editor">
      If you are seeing this, either JavaScript is currently disabled or Rail Announcement
      Generator failed to start. This is a client-side app, so it relies on JavaScript.
      No unrelated, third-party scripts (e.g. ads, analytics) are loaded or used.
    </div>

    <!-- Removes no-js text -->
    <script type="application/javascript">
      // Eventually, the editor will re-apply this message with localization
      document.querySelector('#marquee').innerText = 'Please wait...';
      document.querySelector('#editor').innerText  = 'Please wait...';
    </script>
  </div>

  <!-- The settings screen -->
  <div id="settingsScreen" hidden>
    <menu id="settingsMenu">
      <button tabindex="2" id="btnResetSettings" title="%ST_RESET_T%">
        %ST_RESET%
      </button>

      <button tabindex="2" id="btnSaveSettings" title="%ST_SAVE_T%">
        %ST_SAVE%
      </button>
    </menu>

    <h1>%ST_SPEECH%</h1>

    <form id="frmSpeech">
      <!-- TODO: Localize -->
      <label for="chkUseVox">Use VOX</label>
      <input type="checkbox" id="chkUseVox"/>

      <!-- TODO: Hyperlink to list of voices -->
      <p id="hintUseVox">
        <strong>VOX engine</strong> is Rail Announcement Generator's own speech engine,
        using recorded voices. It is more true to real-life than speech synthesis.
      </p>

      <label hidden for="selVoxVoice">Voice</label>
      <select hidden tabindex="2" id="selVoxVoice">
        <option value="">Custom</option>
        <option value="https://roycurtis.github.io/RAG-VOX-Roy">GitHub - Roy</option>
        <option value="data/vox/Roy">Local - Roy</option>
      </select>

      <label hidden for="inputVoxPath">Custom path</label>
      <input hidden tabindex="2" type="url" id="inputVoxPath">

      <label hidden for="selVoxReverb">Reverb</label>
      <select hidden tabindex="2" id="selVoxReverb">
        <option value="">None</option>
        <option value="ir.stalbans_a_mono.wav">
          The Lady Chapel, St Albans Cathedral
        </option>
        <option value="ir.middle_tunnel_1way_mono.wav">
          Innocent Railway Tunnel, Edinburgh
        </option>
        <option value="ir.grange-centre-paperbangermic10m_0.wav">
          Grange stone circle, County Limerick
        </option>
      </select>

      <label hidden for="selVoxChime">Chime</label>
      <select hidden tabindex="2" id="selVoxChime">
        <option value="">None</option>
        <option value="chime.btm.wav">Bristol Temple Meads</option>
      </select>

      <label for="selSpeechChoice">%ST_SPEECH_CHOICE%</label>
      <select tabindex="2" id="selSpeechChoice">
        <option disabled selected value="">%ST_SPEECH_EMPTY%</option>
      </select>

      <label for="rangeSpeechVol">%ST_SPEECH_VOL%</label>
      <input tabindex="2" id="rangeSpeechVol" type="range"
             min="0.1" max="1.9" value="1" step="0.1"/>

      <label for="rangeSpeechPitch">%ST_SPEECH_PITCH%</label>
      <input tabindex="2" id="rangeSpeechPitch" type="range"
             min="0.1" max="1.9" value="1" step="0.1"/>

      <label for="rangeSpeechRate">%ST_SPEECH_RATE%</label>
      <input tabindex="2" id="rangeSpeechRate" type="range"
             min="0.1" max="1.9" value="1" step="0.1"/>

      <button tabindex="2" id="btnSpeechTest" title="%ST_SPEECH_TEST_T%">
        %ST_SPEECH_TEST%
      </button>
    </form>

    <h1>%ST_LEGAL%</h1>

    <!-- TODO: Move this to ACKNOWLEDGEMENTS.md -->
    <p id="legalBlock">
      Rail Announcement Generator; built by [Roy Curtis] in 2018, under the [MIT license].
      [Source code for this application is freely available and forkable on GitHub].
      Built using [TypeScript], [Stylus], [JetBrains WebStorm], and [Node].
      Uses the [IcoMoon-Free icon pack by Keyamoon]. Uses the [5by7 font by Peter Wiegel].
      Uses the [Draggable library by Shopify].
      With thanks to: [Paul Casillas] for his recordings of station announcements on
      YouTube, [WhatDoTheyKnow] for hosting freedom of information reqest responses that
      contain announcement data, "Mark" for making said FOI requests, and various
      StackOverflow contributors (where attributed) for code snippets and advice.
      Thank you also to [Stitch], [Spin], Tropic, Poster, Devon, [Robro], Grant, Bjarke,
      Nik, Dylan, rjlan, Fyrrian, CGDoctor8, Mikko, Griffin, Leroy, Maitre, Shilo, Pat,
      [Kristi Kates and her entire community] for the love, testing, and encouragement.
      No user-inputted or generated data is ever sent to a remote server, at any time.
      Local storage is used only to store and recall JSON state and application settings,
      on user's explicit and intentional request.
      This application uses phrases, vocabulary, and station names from [National Rail]'s
      official station announcements, and freedom of information requests by other parties
      that are not affiliated with this application.
      This application is not affiliated with, nor endorsed by, National Rail or any of
      the rail networks, companies, councils, towns and communities listed in datasets.
      None of the messages generated by this application are endorsed by either National
      Rail or any of the rail networks, companies, councils, towns and communities
      listed in the datasets, or mentioned in such generated messages.
      This application is just a hobby project; it is not meant for official use in any
      rail station, nor any context where rail customers or spectators may be expecting
      official information or announcements on train and station schedules.
      This application is not meant as a replacement for, or extension of, official
      announcement generating systems used in any rail station or train.
      Obviously, I am not a lawyer, but I hope this text makes it clear enough that this
      is just a hobby of mine, with zero commercial intent. Please enjoy, and thanks!

      [0]:  https://roycurtis.com
      [1]:  https://github.com/RoyCurtis/RAG/blob/master/LICENSE.md
      [2]:  https://github.com/RoyCurtis/RAG
      [3]:  https://www.typescriptlang.org/
      [4]:  http://stylus-lang.com/
      [5]:  https://www.jetbrains.com/webstorm/
      [6]:  https://nodejs.org/en/
      [7]:  https://icomoon.io/
      [8]:  http://www.peter-wiegel.de/5by7.html
      [9]:  https://shopify.github.io/draggable/
      [10]: https://www.youtube.com/channel/UC8Hokjo49qLuy3L4bDS5c8w
      [11]: https://www.whatdotheyknow.com/request/london_overground_announcments
      [12]: https://laken.net/
      [13]: http://calebflatten.com/
      [14]: https://robrotheram.com/
      [15]: https://www.twitch.tv/kristikates
      [16]: http://www.nationalrail.co.uk/
    </p>

  </div>

  <!-- Display size warning -->
  <!-- TODO: Do not show if in no-js mode -->
  <div id="tooSmallScreen" class="warningScreen">
    <h1>%WARN_SHORT_HEADER%</h1>
    <p>%WARN_SHORT%</p>
  </div>

  <!-- UI definitions for phrase element editor dialogs -->

  <div id="coachPicker" hidden class="picker">
    <header></header>

    <form>
      <select title="%P_COACH_T%" tabindex="50"></select>
    </form>
  </div>

  <div id="excusePicker" hidden class="picker fullWidth">
    <header></header>

    <form>
      <chooser
        title="%P_EXCUSE_T%"
        placeholder="%P_EXCUSE_PH%"
        itemTitle="%P_EXCUSE_ITEM_T%"
      ></chooser>
    </form>
  </div>

  <div id="integerPicker" hidden class="picker">
    <header></header>

    <form>
      <input id="integerPickerValue" title="%P_INT_T%" type="number">
      <label for="integerPickerValue"></label>
    </form>
  </div>

  <div id="namedPicker" hidden class="picker fullWidth">
    <header></header>

    <form>
      <chooser
        title="%P_NAMED_T%"
        placeholder="%P_NAMED_PH%"
        itemTitle="%P_NAMED_ITEM_T%"
      ></chooser>
    </form>
  </div>

  <div id="phrasesetPicker" hidden class="picker modal">
    <header></header>

    <form>
      <chooser
        title="%P_PSET_T%"
        placeholder="%P_PSET_PH%"
        itemTitle="%P_PSET_ITEM_T%"
      ></chooser>
    </form>
  </div>

  <div id="platformPicker" hidden class="picker">
    <header></header>

    <form>
      <input title="%P_PLAT_NUMBER_T%" min="0" max="99" type="number">

      <select title="%P_PLAT_LETTER_T%">
        <option value=""></option>
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
      </select>
    </form>
  </div>

  <div id="servicePicker" hidden class="picker fullWidth">
    <header></header>

    <form>
      <chooser
        title="%P_SERV_T%"
        placeholder="%P_SERV_PH%"
        itemTitle="%P_SERV_ITEM_T%"
      ></chooser>
    </form>
  </div>

  <div id="stationPicker" hidden class="picker fullWidth">
    <header></header>

    <form>
      <chooser
        title="%P_STATION_T%"
        placeholder="%P_STATION_PH%"
        itemTitle="%P_STATION_ITEM_T%"
        groupByABC
      ></chooser>
    </form>
  </div>

  <div id="stationlistPicker" hidden class="picker modal">
    <header></header>

    <form>
      <div class="stationList">
        <menu>
          <button class="addStation" tabindex="50" title="%P_SL_ADD_T%">
            %P_SL_ADD%
          </button>

          <button class="closePicker" tabindex="50" title="%P_SL_CLOSE_T%">
            %P_SL_CLOSE%
          </button>
        </menu>

        <p>%P_SL_EMPTY%</p>

        <dl title="%P_SL_DRAG_T%" tabindex="50"></dl>

        <div class="delStation" title="%P_SL_DELETE_T%">%P_SL_DELETE%</div>
      </div>
    </form>
  </div>

  <div id="timePicker" hidden class="picker">
    <header></header>

    <form>
      <input id="timePickerValue" type="time" title="%P_TIME_T%"
             pattern="[0-9]{2}:[0-9]{2}" required>
    </form>
  </div>

  <!-- UI definitions for common controls -->

  <div id="chooserTemplate" hidden class="chooser">
    <input class="chSearchBox" type="text" tabindex="50" title=""/>

    <dl class="chChoicesBox" tabindex="50"></dl>
  </div>

  <dd id="stationListItemTemplate" hidden tabindex="-1" title="%P_SL_ITEM_T%">

  </dd>

</body>

<scripts>
  <!-- Third-party libraries -->
  <script src="js/vendor/draggable.js" type="text/javascript"></script>

  <!-- Application logic -->
  <script src="js/rag.js" type="text/javascript"></script>

  <!-- National Rail phrase sets and vocabulary data -->
  <script src="data/nr_excuses.js"  type="text/javascript"></script>
  <script src="data/nr_named.js"    type="text/javascript"></script>
  <script src="data/nr_services.js" type="text/javascript"></script>
  <script src="data/nr_stations.js" type="text/javascript"></script>
  <!-- Loads RAG synchronously, after loading phrase data -->
  <iframe id="nrPhraseset" hidden src="data/nr_phrases.xml"
          onload="RAG.main({
            phrasesetEmbed: '#nrPhraseset',
            excusesData:    DATA_EXCUSES,
            namedData:      DATA_NAMED,
            servicesData:   DATA_SERVICES,
            stationsData:   DATA_STATIONS
          });"></iframe>
</scripts>

</html>